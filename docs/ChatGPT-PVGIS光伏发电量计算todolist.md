# PVGIS光伏发电量计算方案

**User:** 石凌杰 (mr.lingjie@gmail.com)  
**Created:** 12/28/2025 16:22:17  
**Updated:** 12/28/2025 16:37:28  
**Exported:** 12/28/2025 16:38:32  
**Link:** [https://chatgpt.com/c/6950e8b8-2de0-8333-b026-f1e281e07790](https://chatgpt.com/c/6950e8b8-2de0-8333-b026-f1e281e07790)  

## Response:
下面我把\*\*“任务拆分版”**进一步整理为一份**「TodoList · 开发 Plan 文档」**。  
这个版本更偏**执行视角\*\*，适合：

*   你自己按步骤推进
*   或作为 **项目启动 / 周计划 / AI 辅助开发 checklist**
*   也可以直接贴进 Notion / 飞书文档作为开发计划页

我会做到这几点：

*   ✅ 线性顺序（从 0 → 可交付）
*   ✅ 每一条都是**可勾选 Todo**
*   ✅ 标注【前端 / 后端 / 通用】
*   ✅ 明确“做到什么程度算完成”

* * *

光伏发电量评估模块
=========

TodoList · 开发 Plan 文档
---------------------

* * *

阶段 0｜准备与统一认知（Day 0）
-------------------

### ☐ 0.1 确认技术形态（通用）

*   ☐ 模块嵌入现有 React 应用
*   ☐ 后端采用 API 代理方式调用 PVGIS
*   ☐ 前后端统一使用 JSON 交互

**完成标准**

*   不再讨论“是否直连 PVGIS / 是否前端算”

* * *

### ☐ 0.2 固化计算口径（通用）

*   ☐ 方位角：0°=正南，东负西正
*   ☐ 倾角：PVGIS 最优倾角
*   ☐ 年型：典型年（TMY）
*   ☐ 发电量口径：AC 侧

**完成标准**

*   形成《计算口径说明》一页文档
*   后续所有代码/报告严格遵循

* * *

阶段 1｜位置输入与解析（Day 1）
-------------------

### ☐ 1.1 设计位置输入模式（前端）

*   ☐ 经纬度输入模式
*   ☐ 地址 / 城市输入模式（Tab 切换）

**完成标准**

*   前端能拿到合法 lat / lon

* * *

### ☐ 1.2 地址 → 经纬度解析接口（后端）

*   ☐ 接收地址字符串
*   ☐ 调用地理编码服务
*   ☐ 返回 lat / lon + 精度说明

**完成标准**

*   输入“杭州”可返回合理坐标
*   解析失败有明确错误提示

* * *

阶段 2｜光伏系统参数（Day 2）
------------------

### ☐ 2.1 定义系统参数默认值（通用）

*   ☐ 装机容量默认值（如 10 kWp）
*   ☐ 方位角默认值（0°）
*   ☐ 系统损耗默认值（如 14%）

**完成标准**

*   所有参数都有默认值
*   用户不输入也能计算

* * *

### ☐ 2.2 参数输入组件（前端）

*   ☐ 装机容量输入（kWp）
*   ☐ 方位角输入（°）
*   ☐ 系统损耗输入（%）
*   ☐ 参数修改触发重新计算

**完成标准**

*   改参数 → 结果变化

* * *

### ☐ 2.3 参数校验与归一化（后端）

*   ☐ 数值范围校验
*   ☐ 方位角转换为 PVGIS 口径
*   ☐ 倾角不传，交给 PVGIS optimal

**完成标准**

*   非法参数被拒绝
*   PVGIS 请求参数始终合法

* * *

阶段 3｜PVGIS 接入（核心阶段）（Day 3–4）
----------------------------

### ☐ 3.1 PVGIS 请求参数封装（后端）

*   ☐ 固定使用 TMY
*   ☐ 固定 AC 输出
*   ☐ 固定 optimal tilt
*   ☐ 封装为统一函数

**完成标准**

*   给定参数可生成稳定 PVGIS 请求

* * *

### ☐ 3.2 年 / 月发电量计算接口（后端）

*   ☐ 调用 PVGIS
*   ☐ 解析年发电量（kWh）
*   ☐ 解析 12 个月发电量

**完成标准**

*   不同地点返回合理年/月数据

* * *

### ☐ 3.3 典型年逐时数据接口（后端）

*   ☐ 返回 8760 条记录
*   ☐ 每条包含：
    *   时间
    *   AC 发电功率
    *   POA 辐照

**完成标准**

*   时间连续
*   数量 = 8760

* * *

阶段 4｜衍生指标计算（Day 4）
------------------

### ☐ 4.1 首年满发小时计算（后端）

*   ☐ 年发电量 ÷ 装机容量

**完成标准**

*   计算结果可人工复核

* * *

### ☐ 4.2 PR 计算（后端）

*   ☐ 累计年 POA 辐照
*   ☐ 按 PR 标准公式计算

**完成标准**

*   PR 数值在 0.6–0.85 合理区间

* * *

阶段 5｜结果展示（Day 5）
----------------

### ☐ 5.1 关键指标展示（前端）

*   ☐ 年发电量
*   ☐ PR
*   ☐ 首年满发小时

**完成标准**

*   一眼能看懂项目质量

* * *

### ☐ 5.2 月度发电量图表（前端）

*   ☐ 12 个月柱状图
*   ☐ 数值与接口一致

* * *

### ☐ 5.3 逐时曲线展示（前端）

*   ☐ 日内逐时曲线
*   ☐ 支持按月份查看

**完成标准**

*   曲线符合光伏日照规律

* * *

阶段 6｜方案对比（Day 6）
----------------

### ☐ 6.1 多方案结构设计（前端）

*   ☐ 同一位置支持 A/B/C 方案
*   ☐ 每个方案独立参数

* * *

### ☐ 6.2 方案对比展示（前端）

*   ☐ 年发电量对比
*   ☐ PR 对比
*   ☐ 满发小时对比

**完成标准**

*   参数变化 → 差异直观

* * *

阶段 7｜稳定性与性能（Day 6–7）
--------------------

### ☐ 7.1 结果缓存（后端）

*   ☐ 缓存 key = lat + lon + 参数
*   ☐ 命中缓存不再请求 PVGIS

* * *

### ☐ 7.2 异常与重试机制（后端）

*   ☐ PVGIS 超时处理
*   ☐ 用户友好错误提示

* * *

阶段 8｜报告导出（Day 7–8）
------------------

### ☐ 8.1 报告数据结构定义（通用）

*   ☐ 项目基本信息
*   ☐ 参数
*   ☐ 结果与指标
*   ☐ 数据来源说明

* * *

### ☐ 8.2 PDF 报告生成（后端）

*   ☐ 固定模板
*   ☐ 自动生成 PDF

**完成标准**

*   可直接交付客户

* * *

阶段 9｜收尾与交付（Day 9）
-----------------

### ☐ 9.1 核心计算结果人工抽检

*   ☐ 选 2–3 个城市验证合理性

### ☐ 9.2 使用说明整理

*   ☐ 参数说明
*   ☐ 适用场景说明
*   ☐ 风险与限制说明

* * *

🎯 最终完成定义（Definition of Done）
-----------------------------

*   ✅ 输入任意位置 → 输出完整评估结果
*   ✅ 年 / 月 / 逐时数据一致
*   ✅ PR、满发小时口径清晰
*   ✅ 报告可直接对外使用

